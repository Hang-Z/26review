<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>实人风控 - 离线大模型研发与成果</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #f5f3ff 0%, #e8e5ff 100%);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* 标题部分 */
        .header-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .main-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .subtitle {
            font-size: 1.15rem;
            color: #666;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* 内容卡片 */
        .content-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid linear-gradient(90deg, #667eea, #764ba2);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 600;
        }

        .subsection-title {
            font-size: 1.4rem;
            color: #34495e;
            margin: 30px 0 20px;
            font-weight: 600;
        }

        .content-text {
            line-height: 1.8;
            color: #444;
            margin-bottom: 20px;
            font-size: 1.05rem;
        }

        /* 挑战卡片 */
        .challenge-box {
            background: linear-gradient(135deg, #fff3e0, #ffe0b2);
            border-left: 4px solid #ff9800;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }

        .challenge-title {
            font-weight: 600;
            color: #e65100;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        /* 模型结构图占位 */
        .model-diagram {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .model-diagram img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        /* Stage卡片 */
        .stages-container {
            margin: 30px 0;
        }

        .stage-card {
            background: linear-gradient(135deg, #f8f9fa, #ffffff);
            border-left: 5px solid #667eea;
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }

        .stage-card:hover {
            transform: translateX(5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .stage-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .stage-number {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            font-size: 1.2rem;
        }

        .stage-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .stage-content {
            margin-left: 60px;
            color: #555;
            line-height: 1.7;
        }

        .stage-metric {
            display: inline-block;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            margin: 10px 0;
        }

        /* 归因效果展示 */
        .attribution-results {
            background: #e8f5e9;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
        }

        .attribution-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .attribution-item {
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .attribution-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 8px;
        }

        .attribution-before {
            color: #e74c3c;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .attribution-arrow {
            color: #95a5a6;
            margin: 0 10px;
        }

        .attribution-after {
            color: #27ae60;
            font-size: 1.3rem;
            font-weight: 600;
        }

        /* 业务成果部分 */
        .result-section {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .result-title {
            font-size: 1.5rem;
            color: #1e40af;
            margin-bottom: 20px;
            font-weight: 600;
        }

        /* 数据对比卡片 */
        .comparison-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .comparison-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            text-align: center;
            transition: all 0.3s ease;
        }

        .comparison-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .comparison-card.model {
            border-top: 4px solid #667eea;
        }

        .comparison-card.human {
            border-top: 4px solid #9b59b6;
        }

        .comparison-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .metric-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .metric-label {
            color: #666;
            font-size: 0.95rem;
        }

        .metric-value {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .metric-value.good {
            color: #27ae60;
        }

        .metric-value.poor {
            color: #e74c3c;
        }

        /* 核心价值 */
        .value-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .value-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .value-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            color: white;
            font-size: 1.8rem;
        }

        .value-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .value-desc {
            color: #666;
            line-height: 1.6;
        }

        /* 图表部分样式（来自原HTML） */
        .chart-section {
            background: white;
            border-radius: 20px;
            margin: 30px 0;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        }

        .chart-title {
            font-size: 1.6em;
            color: #333;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
            text-align: center;
        }

        .chart-subtitle {
            font-size: 0.9em;
            color: #666;
            font-weight: normal;
            display: block;
            margin-top: 8px;
        }

        .data-summary {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            margin: 20px 0;
        }

        .summary-title {
            font-size: 1.1em;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .summary-value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .summary-breakdown {
            font-size: 1em;
            opacity: 0.85;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .main-title {
                font-size: 1.8rem;
            }
            
            .comparison-container,
            .value-cards {
                grid-template-columns: 1fr;
            }
            
            .stage-content {
                margin-left: 0;
                margin-top: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 标题部分 -->
        <div class="header-section">
            <h1 class="main-title">实人风控 - 前瞻性布局与成果</h1>
            <p class="subtitle">
                构建"可归因、可交互"的实人风控大模型，实现从"看不清"到"说得清"的技术突破
            </p>
        </div>

        <!-- 前瞻性布局部分 -->
        <div class="content-card">
            <h2 class="section-title">🚀 前瞻性布局：构建"可归因、可交互"的实人风控大模型</h2>
            
            <!-- 背景与挑战 -->
            <h3 class="subsection-title">1. 背景与挑战</h3>
            <p class="content-text">
                随着AIGC技术的快速迭代，纯图像算法在面对高伪装性攻击时已逐渐失效。然而，业界主流的多模态大模型同样存在"水土不服"的问题：
            </p>
            
            <div class="challenge-box">
                <div class="challenge-title">⚠️ 核心挑战</div>
                <p>
                    业界模型的训练多以Image Caption等粗粒度任务为主，视觉编码器缺乏像素级的细粒度理解能力。
                    这导致它们在AIGC检测任务上，不仅判别准确率低，且归因时常出现严重的幻觉问题，
                    无法"看清"也"说不清"风险。
                </p>
            </div>

            <!-- 核心思路 -->
            <h3 class="subsection-title">2. 核心思路与技术路径</h3>
            <p class="content-text">
                为解决上述难题，我们设计并研发了一款可与自身"交互"的多模态大模型。
                其核心思路是模仿人类专家的"全局观察→聚焦细节"的判别过程，
                通过在推理中输出特殊Token，触发对可疑区域的自动裁剪与第二轮细粒度推理。
            </p>

            <!-- 模型结构图 -->
            <div class="model-diagram">
                <img src="大1.png" alt="大模型结构示意图">
                <p style="margin-top: 15px; color: #666; font-size: 0.95rem;">
                    实人风控大模型架构：多阶段训练实现可交互、可归因的智能判别
                </p>
            </div>

            <!-- 多阶段优化路径 -->
            <p class="content-text" style="margin-top: 30px;">
                我们的模型研发遵循了严谨的多阶段优化路径：
            </p>

            <div class="stages-container">
                <!-- Stage 1 -->
                <div class="stage-card">
                    <div class="stage-header">
                        <div class="stage-number">1</div>
                        <div class="stage-title">视觉对齐</div>
                    </div>
                    <div class="stage-content">
                        首先冻结LLM并专注训练ViT。为解决"注意力坍缩"的捷径学习问题，
                        我们引入了"注意力熵引导机制"来确保视觉模块能有效关注全局特征。
                        <br>
                        <span class="stage-metric">召回率 93.7% (FPR 0.1%)</span>
                    </div>
                </div>

                <!-- Stage 2 -->
                <div class="stage-card">
                    <div class="stage-header">
                        <div class="stage-number">2</div>
                        <div class="stage-title">图文融合</div>
                    </div>
                    <div class="stage-content">
                        在此阶段进行端到端SFT微调。为解决模型输出"过度自信"（Logits两极化）的问题，
                        我们结合了"熵正则化"与"Mixup"技术来提升模型的校准性。
                        <br>
                        <span class="stage-metric">召回率 95.2% (FPR 0.1%)</span>
                    </div>
                </div>

                <!-- Stage 3 -->
                <div class="stage-card">
                    <div class="stage-header">
                        <div class="stage-number">3</div>
                        <div class="stage-title">交互学习</div>
                    </div>
                    <div class="stage-content">
                        采用PPO强化学习，训练模型在合适的时机输出特殊Token以开启二轮推理。
                        为解决模型"骗取奖励"的问题，我们设计了"基于置信度的奖励函数"，
                        使模型学会在真正不确定时才请求"细看"。
                        <br>
                        <span class="stage-metric">召回率 96.9% (FPR 0.1%)</span>
                    </div>
                </div>

                <!-- Stage 4 -->
                <div class="stage-card">
                    <div class="stage-header">
                        <div class="stage-number">4</div>
                        <div class="stage-title">归因优化</div>
                    </div>
                    <div class="stage-content">
                        为解决归因任务与判别任务间的"梯度冲突"，
                        我们采用了Cascade RL（MPO→GSPO）的渐进式优化策略，
                        在不损伤判别能力的前提下，大幅提升了归因质量。
                    </div>
                </div>
            </div>

            <!-- 归因效果 -->
            <div class="attribution-results">
                <h4 style="color: #2e7d32; font-size: 1.2rem; margin-bottom: 15px;">
                    📊 归因效果提升 (500条样本评测)
                </h4>
                <div class="attribution-grid">
                    <div class="attribution-item">
                        <div class="attribution-label">关键词覆盖率</div>
                        <span class="attribution-before">46.8%</span>
                        <span class="attribution-arrow">→</span>
                        <span class="attribution-after">92.2%</span>
                    </div>
                    <div class="attribution-item">
                        <div class="attribution-label">幻觉问题比例</div>
                        <span class="attribution-before">22.4%</span>
                        <span class="attribution-arrow">→</span>
                        <span class="attribution-after">2.8%</span>
                    </div>
                    <div class="attribution-item">
                        <div class="attribution-label">"正确废话"比例</div>
                        <span class="attribution-before">39.2%</span>
                        <span class="attribution-arrow">→</span>
                        <span class="attribution-after">8.6%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 业务成果部分 -->
        <div class="content-card">
            <h2 class="section-title">🏆 业务成果：赋能离线审核，量化人审水位</h2>
            
            <p class="content-text">
                我们将训练完成的大模型用于离线样本的自动化审核，并与同数据集下的人工审核结果进行对比，
                其价值得到了充分验证。
            </p>

            <!-- 数据集概览 -->
            <div class="data-summary">
                <div class="summary-title">📊 数据集规模</div>
                <div class="summary-value">19.5万条</div>
                <div class="summary-breakdown">真实黑样本 3.15万（16.2%） | 真实白样本 16.35万（83.8%）</div>
            </div>

            <!-- 对比数据展示 -->
            <div class="comparison-container">
                <div class="comparison-card model">
                    <div class="comparison-title">🤖 离线大模型表现</div>
                    <div class="metric-row">
                        <span class="metric-label">召回率 (TPR)</span>
                        <span class="metric-value good">90.5%</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">误拦率 (FPR)</span>
                        <span class="metric-value good">0.12%</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">综合准确率</span>
                        <span class="metric-value good">98.4%</span>
                    </div>
                </div>

                <div class="comparison-card human">
                    <div class="comparison-title">👥 人工审核表现</div>
                    <div class="metric-row">
                        <span class="metric-label">召回率 (TPR)</span>
                        <span class="metric-value poor">49.1%</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">误拦率 (FPR)</span>
                        <span class="metric-value poor">0.92%</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">综合准确率</span>
                        <span class="metric-value poor">91.0%</span>
                    </div>
                </div>
            </div>

            <div class="result-section">
                <div class="result-title">💡 核心发现</div>
                <p style="margin-bottom: 15px; line-height: 1.7;">
                    如图所示，在对<strong>19.5万</strong>条线上真实样本的审核中：
                </p>
                <ul style="list-style: none; padding: 0;">
                    <li style="margin-bottom: 15px; padding-left: 20px;">
                        <strong>• 大模型展现了远超人工的审核能力：</strong>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li style="margin-bottom: 8px;">
                                <strong>召回率：</strong> 大模型达到 <span style="color: #27ae60; font-weight: bold;">90.5%</span>，
                                而人工审核仅为 <span style="color: #e74c3c; font-weight: bold;">49.1%</span>，
                                这意味着大模型能发现比人工多近一倍的黑样本
                            </li>
                            <li style="margin-bottom: 8px;">
                                <strong>误拦率：</strong> 大模型仅为 <span style="color: #27ae60; font-weight: bold;">0.12%</span>，
                                远低于人工的 <span style="color: #e74c3c; font-weight: bold;">0.92%</span>，
                                展现了极高的准确性
                            </li>
                            <li>
                                <strong>综合准确率：</strong> 大模型综合准确率高达 <span style="color: #27ae60; font-weight: bold;">98.4%</span>，
                                显著优于人工的 <span style="color: #e74c3c; font-weight: bold;">91.0%</span>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>

            <!-- 数据流向图 -->
            <div class="chart-section">
                <h2 class="chart-title">
                    📊 数据流向分析图
                    <span class="chart-subtitle">流线宽度准确反映数据比例，清晰对比召回率差异</span>
                </h2>
                <div id="sankey-chart" style="height: 700px;"></div>
            </div>

            <!-- 核心价值 -->
            <div class="value-cards">
                <div class="value-card">
                    <div class="value-icon">⚡</div>
                    <div class="value-title">提效与增质</div>
                    <div class="value-desc">
                        证明了大模型完全有能力承接乃至替代绝大部分离线审核工作，
                        实现降本增效，并将人力解放出来聚焦于更复杂的分析任务。
                    </div>
                </div>
                <div class="value-card">
                    <div class="value-icon">📏</div>
                    <div class="value-title">量化标准</div>
                    <div class="value-desc">
                        首次精准地量化了线上人审的真实能力水位，为未来制定更科学的运营SOP、
                        优化人审流程、以及衡量其他风控组件的价值提供了可靠的数据基线。
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 数据准备
        const total_samples = 195000;
        const actual_black = 31549;
        const actual_white = 163451;

        const human_tp = 15478;
        const human_fp = 1522;
        const human_fn = 16049;
        const human_tn = 161951;

        const model_tp = 28551;
        const model_fp = 196;
        const model_fn = 2998;
        const model_tn = 163255;

        // 绘制改进的桑基图
        function drawSankey() {
            const data = [{
                type: "sankey",
                orientation: "h",
                node: {
                    pad: 30,
                    thickness: 25,
                    line: {
                        color: "#333",
                        width: 1
                    },
                    label: [
                        // 左侧：原始数据
                        `总样本\n195.0K`,              // 0
                        `真实黑样本\n31.5K\n(16.2%)`,   // 1
                        `真实白样本\n163.5K\n(83.8%)`,  // 2
                        
                        // 中间：人审判断
                        `👥 人审判黑\n17.0K`,           // 3
                        `👥 人审判白\n178.0K`,          // 4
                        
                        // 中间：模型判断
                        `🤖 模型判黑\n28.7K`,           // 5
                        `🤖 模型判白\n166.3K`,          // 6
                        
                        // 右侧：最终结果
                        `✓ 正确识别黑`,                // 7
                        `✗ 漏判黑`,                    // 8
                        `✗ 误拦白`,                    // 9
                        `✓ 正确放过白`                 // 10
                    ],
                    color: [
                        "#95a5a6",  // 总样本
                        "#e74c3c",  // 真实黑
                        "#3498db",  // 真实白
                        "#9b59b6",  // 人审判黑
                        "#8e44ad",  // 人审判白
                        "#667eea",  // 模型判黑
                        "#764ba2",  // 模型判白
                        "#27ae60",  // 正确识别
                        "#c0392b",  // 漏判
                        "#e74c3c",  // 误拦
                        "#27ae60"   // 正确放过
                    ]
                },
                link: {
                    source: [
                        // 总样本分流
                        0, 0,
                        
                        // 黑样本到人审
                        1, 1,
                        // 白样本到人审
                        2, 2,
                        
                        // 黑样本到模型
                        1, 1,
                        // 白样本到模型
                        2, 2,
                        
                        // 人审判断到结果
                        3, 3,   // 人审判黑
                        4, 4,   // 人审判白
                        
                        // 模型判断到结果
                        5, 5,   // 模型判黑
                        6, 6    // 模型判白
                    ],
                    target: [
                        // 总样本分流
                        1, 2,
                        
                        // 黑样本到人审
                        3, 4,
                        // 白样本到人审
                        3, 4,
                        
                        // 黑样本到模型
                        5, 6,
                        // 白样本到模型
                        5, 6,
                        
                        // 人审判断到结果
                        7, 9,   // 判黑->正确/误拦
                        10, 8,  // 判白->正确/漏判
                        
                        // 模型判断到结果
                        7, 9,   // 判黑->正确/误拦
                        10, 8   // 判白->正确/漏判
                    ],
                    value: [
                        // 总样本分流
                        actual_black, actual_white,
                        
                        // 人审
                        human_tp, human_fn,  // 黑样本
                        human_fp, human_tn,  // 白样本
                        
                        // 模型
                        model_tp, model_fn,  // 黑样本
                        model_fp, model_tn,  // 白样本
                        
                        // 人审结果
                        human_tp, human_fp,  // 判黑
                        human_tn, human_fn,  // 判白
                        
                        // 模型结果
                        model_tp, model_fp,  // 判黑
                        model_tn, model_fn   // 判白
                    ],
                    color: [
                        // 根据流向设置颜色
                        "rgba(231, 76, 60, 0.4)",    // 总->黑
                        "rgba(52, 152, 219, 0.4)",   // 总->白
                        
                        // 人审
                        "rgba(155, 89, 182, 0.6)",   // 黑->人审判黑（召回）
                        "rgba(155, 89, 182, 0.3)",   // 黑->人审判白（漏判）
                        "rgba(155, 89, 182, 0.3)",   // 白->人审判黑（误拦）
                        "rgba(155, 89, 182, 0.6)",   // 白->人审判白（正确）
                        
                        // 模型
                        "rgba(102, 126, 234, 0.7)",   // 黑->模型判黑（召回）
                        "rgba(102, 126, 234, 0.3)",   // 黑->模型判白（漏判）
                        "rgba(102, 126, 234, 0.3)",   // 白->模型判黑（误拦）
                        "rgba(102, 126, 234, 0.7)",   // 白->模型判白（正确）
                        
                        // 结果
                        "rgba(39, 174, 96, 0.6)",    // 人审正确识别
                        "rgba(231, 76, 60, 0.6)",    // 人审误拦
                        "rgba(39, 174, 96, 0.6)",    // 人审正确放过
                        "rgba(231, 76, 60, 0.6)",    // 人审漏判
                        
                        "rgba(39, 174, 96, 0.6)",    // 模型正确识别
                        "rgba(231, 76, 60, 0.6)",    // 模型误拦
                        "rgba(39, 174, 96, 0.6)",    // 模型正确放过
                        "rgba(231, 76, 60, 0.6)"     // 模型漏判
                    ],
                    label: [
                        "", "",
                        
                        // 人审
                        `人审召回 ${(human_tp/actual_black*100).toFixed(1)}%`,
                        `人审漏判 ${(human_fn/actual_black*100).toFixed(1)}%`,
                        `人审误拦 ${(human_fp/actual_white*100).toFixed(2)}%`,
                        `正确放过`,
                        
                        // 模型
                        `模型召回 ${(model_tp/actual_black*100).toFixed(1)}%`,
                        `模型漏判 ${(model_fn/actual_black*100).toFixed(1)}%`,
                        `模型误拦 ${(model_fp/actual_white*100).toFixed(2)}%`,
                        `正确放过`,
                        
                        // 结果
                        `${(human_tp/1000).toFixed(1)}K`,
                        `${(human_fp/1000).toFixed(1)}K`,
                        `${(human_tn/1000).toFixed(1)}K`,
                        `${(human_fn/1000).toFixed(1)}K`,
                        
                        `${(model_tp/1000).toFixed(1)}K`,
                        `${model_fp}个`,
                        `${(model_tn/1000).toFixed(1)}K`,
                        `${(model_fn/1000).toFixed(1)}K`
                    ],
                    hovertemplate: '%{label}<br>数量: %{value:,.0f}<extra></extra>'
                }
            }];

            const layout = {
                font: {
                    size: 13,
                    family: 'Microsoft YaHei, Segoe UI, sans-serif'
                },
                margin: {
                    l: 20,
                    r: 150,
                    t: 30,
                    b: 30
                },
                paper_bgcolor: 'white',
                plot_bgcolor: 'white'
            };

            const config = {
                responsive: true,
                displayModeBar: false
            };

            Plotly.newPlot('sankey-chart', data, layout, config);
        }

        // 页面加载完成后绘制图表
        document.addEventListener('DOMContentLoaded', function() {
            drawSankey();
        });

        // 窗口大小改变时重绘
        window.addEventListener('resize', function() {
            Plotly.Plots.resize('sankey-chart');
        });
    </script>
</body>
</html>